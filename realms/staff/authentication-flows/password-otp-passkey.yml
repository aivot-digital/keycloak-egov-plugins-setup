alias: passkey oder username mit otp
description: Login mit Passkey oder Username und Passwort sowie OTP oder Recovery wenn kein OTP konfiguriert ist
steps:
  - auth: auth-cookie
    requirement: ALTERNATIVE
  - auth: identity-provider-redirector
    requirement: ALTERNATIVE
  - alias: pupo_login
    description: Login mit Passkey oder Username und Passwort sowie OTP oder Recovery wenn kein OTP konfiguriert ist
    requirement: ALTERNATIVE
    steps:
      - auth: auth-username-password-form
        requirement: REQUIRED
      - alias: pupo_passkey_conditional
        description: Anmeldung mit Passkey oder Eingabe von OTP oder Recovery Code je nach Benutzerkonfiguration
        requirement: REQUIRED
        steps:
          - auth: conditional-credential
            authenticatorConfig:
              alias: passkey-only
              credentials: webauthn-passwordless
            requirement: REQUIRED
          - alias: pupo_otp_recovery
            description: Eingabe von OTP oder Recovery Code je nach Benutzerkonfiguration
            requirement: REQUIRED
            steps:
              - alias: pupo_otp
                description: Eingabe des OTP wenn der Benutzer OTP konfiguriert hat
                requirement: CONDITIONAL
                steps:
                  - auth: conditional-user-configured
                    requirement: REQUIRED
                  - auth: auth-otp-form
                    requirement: REQUIRED
              - alias: pupo_recovery
                description: Eingabe des Recovery Codes wenn der Benutzer kein OTP konfiguriert hat
                requirement: CONDITIONAL
                steps:
                  - auth: conditional-user-configured
                    requirement: REQUIRED
                  - auth: auth-recovery-authn-code-form
                    requirement: REQUIRED
