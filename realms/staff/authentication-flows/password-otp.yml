alias: username und otp
description: Login mit Username und Passwort sowie OTP oder Recovery wenn kein OTP konfiguriert ist
steps:
  - auth: auth-cookie
    requirement: ALTERNATIVE
  - auth: identity-provider-redirector
    requirement: ALTERNATIVE
  - alias: upo_login
    description: Login mit Username und Passwort sowie OTP oder Recovery wenn kein OTP konfiguriert ist
    requirement: ALTERNATIVE
    steps:
      - auth: auth-username-password-form
        requirement: REQUIRED
      - alias: opo_otp_recovery
        description: Eingabe von OTP oder Recovery Code je nach Benutzerkonfiguration
        requirement: REQUIRED
        steps:
          - alias: upo_otp
            description: Eingabe des OTP wenn der Benutzer OTP konfiguriert hat
            requirement: ALTERNATIVE
            steps:
              - auth: conditional-user-configured
                requirement: REQUIRED
              - auth: auth-otp-form
                requirement: REQUIRED
          - alias: upo_recovery
            description: Eingabe des Recovery Codes wenn der Benutzer kein OTP konfiguriert hat
            requirement: ALTERNATIVE
            steps:
              - auth: conditional-user-configured
                requirement: REQUIRED
              - auth: auth-recovery-authn-code-form
                requirement: REQUIRED
