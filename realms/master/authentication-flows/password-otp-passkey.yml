alias: passkey oder username mit otp
description: Login mit Passkey oder Username und Passwort sowie OTP oder Recovery wenn kein OTP konfiguriert ist
steps:
  - auth: auth-cookie
    requirement: ALTERNATIVE
  - auth: identity-provider-redirector
    requirement: ALTERNATIVE
  - alias: Faktoren
    requirement: ALTERNATIVE
    steps:
      - auth: auth-username-password-form
        requirement: REQUIRED
      - alias: Passkey oder OTP oder Recovery
        requirement: REQUIRED
        steps:
          - auth: conditional-credential
            authenticatorConfig:
               alias: passkey-only
               credentials: webauthn-passwordless
            requirement: REQUIRED
          - alias: Faktor OTP oder Recovery
            requirement: REQUIRED
            steps:
              - alias: Faktor OTP
                requirement: CONDITIONAL
                steps:
                  - auth: conditional-user-configured
                    requirement: REQUIRED
                  - auth: auth-otp-form
                    requirement: REQUIRED
              - alias: Faktor Recovery
                requirement: CONDITIONAL
                steps:
                  - auth: conditional-user-configured
                    requirement: REQUIRED
                  - auth: auth-recovery-authn-code-form
                    requirement: REQUIRED
